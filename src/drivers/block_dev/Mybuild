package embox.driver

module block_common {
	@IncludeExport(path="drivers")
	source "block_dev.h"

	option number dev_quantity = 8
	option number default_block_size = 512
	source "block_dev.c"
	source "block_dev_namer.c"

	depends embox.compat.posix.fs.libgen
	depends embox.mem.phymem
	depends embox.fs.buffer_cache
	depends embox.fs.buffer_crypt_api
	depends embox.mem.phymem
	depends embox.mem.heap_place
}

@DefaultImpl(block_oldfs)
abstract module block_api {
}

/* Deprecated version */
module block_oldfs extends block_api {
	source "block_dev_idesc_oldfs.c"

	depends block_common
	depends embox.fs.buffer_cache
	depends embox.fs.buffer_crypt_api
	depends embox.fs.rootfs
	depends embox.fs.core
	depends embox.util.LibUtil
	depends embox.util.indexator
	depends embox.mem.phymem
}

/* New version */
module block_dvfs extends block_api {
	source "block_dev_idesc_dvfs.c"

	depends block_common
	depends embox.driver.common
}
