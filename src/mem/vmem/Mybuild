package embox.mem

module vmem_header {
	@IncludeExport(path="mem")
	source "vmem.h"
}

@DefaultImpl(vmem_nommu)
abstract module vmem_api {
	depends vmem_header
}

module vmem_nommu extends vmem_api {

	source "vmem_nommu.c"

	depends vmem_header
	depends embox.mem.mmap_header
	depends embox.mem.mmap
	depends embox.kernel.task.resource.mmap
	depends embox.fs.syslib.idesc_mmap_api
}

module vmem extends vmem_api {
	option number log_level = 1

	source "vmem.c"
	source "mapper.c"
	source "vmem_context.c"

	source "alloc.c"

	source "vmem_page.lds.S"

	depends embox.mem.page_api
	depends embox.arch.mmu

	depends embox.mem.mmap_header
	depends embox.mem.mmap
	depends embox.fs.syslib.idesc_mmap_api
	depends vmem_header
	depends embox.kernel.task.kernel_task
	depends embox.kernel.task.resource.mmap
	depends embox.driver.periph_memory_mmap

	depends embox.mem.vmem_device_memory_full
}
